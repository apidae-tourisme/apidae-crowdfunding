<% content_for :included_scripts do %>
  <script>
      document.addEventListener("DOMContentLoaded", function (event) {
          if (navigator.userAgent.indexOf('MSIE') !== -1 || navigator.appVersion.indexOf('Trident/') > -1) {
              document.body.classList.add('ie_browser');
          }
      });
  </script>
<% end %>
<header class="w100">
  <%= render 'shared/header' %>
</header>
<div class="<%= @page.home? ? 'home_content' : 'generic_content' %>">
  <% if @page.home? %>
    <div>
      <section id="home_data">
        <div id="data_charts" class="w100 mw1140p center">
          <div id="home_map"></div>
          <div id="rank_chart_wrapper" class="txtleft ptl">
            <p class="u-uppercase u-big ma0 lh"><strong class="u-big">SOCIÉTAIRES</strong><br/>Nouvelles arrivées</p>
            <p class="u-smaller">Échelle non-linéaire</p>
            <div id="rank_chart"></div>
            <button class="js-modal btn btn--small mtm aic" data-modal-prefix-class="simple-animated"
                    data-modal-content-id="all_subscriptions" data-modal-describedby-id="modal_description"
                    data-modal-title="Toutes les déclarations d'intention" data-modal-close-text="Fermer" data-modal-close-title="Fermer la fenêtre"
                    aria-haspopup="dialog" onclick="loadSubscriptions()">
              <i class="u-bigger fas fa-chevron-circle-right prs"></i><span>Toutes les déclarations d'intention</span>
            </button>
          </div>
          <div id="pie_chart_container" class="txtleft mtl plm pbm">
            <p class="u-uppercase u-big ma0 lh"><strong class="u-big">Déclarations d'intention</strong><br/>par catégorie</p>
            <div id="pie_chart_wrapper">
              <div id="pie_chart"></div>
              <div id="pie_legend" class="flex-container--column"></div>
            </div>
          </div>
        </div>
      </section>
    </div>
  <% end %>
  <section class="page_content">
    <div class="w100 mw1140p center">
      <% @page.sections.each do |s| %>
        <%= render_page_section(s, true) %>
      <% end %>
    </div>
  </section>
  <% if @page.home? %>
    <div id="all_subscriptions" class="is-hidden">
      <div id="subscriptions_wrapper"></div>
    </div>
  <% end %>
</div>
<%= render 'shared/footer' %>
